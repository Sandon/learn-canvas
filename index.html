<!DOCTYPE html>
<html>
<head>
    <title>learn canvas</title>

    <!--[if lt IE 9]>
        <script type="text/javascript" src="Flashcanvas/flashcanvas.js"></script>
    <![endif]-->
    <script type="text/javascript" src="Flashcanvas/canvas2png.js"></script>
    <script type="text/javascript" src="jquery-1.9.0.js"> </script>
</head>
<body>
<div class="wrap">
    <div style="border: 1px solid green;width: 500px;height: 500px;" id="target">
        <canvas width="500" height="500" id="canvas">
            your browse not support canvas
        </canvas>

    </div>
    <a href="#" id="save-as-img">save as img</a>
</div>

<script type="text/javascript">
    //window.addEventListener('load',eventWindowLoaded,false);
    $(function(){
        eventWindowLoaded();
    });
    function eventWindowLoaded(){
        canvasApp();
        initSaveAsImg();
    }
    var canvas=document.getElementById("canvas");
    function canvasApp(){
        /*var canvas = document.createElement("canvas");
        document.getElementById("target").appendChild(canvas);
        if (typeof FlashCanvas != "undefined") {
            FlashCanvas.initElement(canvas);
        }*/
        var context=canvas.getContext("2d");
        var ready={
            testSaveRestore:function(){
                context.strokeStyle="#fff";
                context.save();
                context.strokeStyle="#000";

                console.log("before restored:"+context.strokeStyle);//#000
                context.restore();
                console.log("after restored:"+context.strokeStyle);//#fff
            },
            useClosePath:function(){
                context.beginPath();
                context.moveTo(20,20);
                context.lineTo(20,100);
                context.lineTo(70,100);
                //context.closePath();
                context.stroke();
            },
            useLineTo:function(){
                //context.beginPath();
                context.strokeStyle="blue";
                context.lineWidth=20;
                context.lineCap="round";
                context.lineJoin="bevel";

                context.moveTo(20,20);
                context.lineTo(50,20);
                context.lineTo(50,50);
                context.stroke();
                //context.closePath();

                //context.beginPath();
                context.lineCap="butt";
                context.lineJoin="miter";
                context.moveTo(20,100);
                context.lineTo(50,100);
                context.lineTo(50,130);
                context.stroke();

            },
            useArc:function(){
                context.beginPath();
                context.strokeStyle="black";
                context.lineWidth=5;
                context.arc(100,100,20,(Math.PI/180)*0,(Math.PI/180)*270,false);

                context.stroke();
                //context.closePath();

                //context.beginPath();
                context.moveTo(10,10);
                context.lineTo(30,10);
                context.lineTo(30,30);
                context.closePath();
                context.stroke();
            },
            useArcTo:function(){
                context.beginPath();
                context.strokeStyle="black";
                context.lineWidth=5;

                context.moveTo(0,0);
                context.lineTo(100,200);
                context.arcTo(350,350,100,100,20);

                context.stroke();
            },
            useQuadraticCurveTo:function(){
                context.beginPath();
                context.strokeStyle="blue";
                context.lineWidth=5;

                context.moveTo(0,0);
                context.quadraticCurveTo(100,25,0,50);
                //context.closePath();
                context.stroke();


                context.beginPath();
                console.log(context.lineWidth);
                context.strokeStyle="red";
                context.arc(100,25 ,2, (Math.PI/100)*0,(Math.PI)*360,false);

                context.stroke();
            },
            useBizierCurveTo:function(){
                context.beginPath();
                context.strokeStyle="blue";
                context.lineWidth=5;

                context.moveTo(150,0);
                context.bezierCurveTo(0,125,300,175,150,300);

                context.stroke();
                context.closePath();

                context.beginPath();
                context.strokeStyle="red";
                context.arc(0,125 ,2, (Math.PI/100)*0,(Math.PI)*360,false);

                context.stroke();
                context.closePath();

                context.beginPath();
                context.strokeStyle="red";
                context.arc(300,175 ,2, (Math.PI/100)*0,(Math.PI)*360,false);

                context.stroke();
                context.closePath();
            },
            useClip:function(){
                //在屏幕上绘制一个大正方形
                context.fillStyle="#000" ;
                context.fillRect(10,10,200,200);
                context.save();

                context.beginPath();
                //裁切画布从(0,0)点开始50*50的正方形
                context.lineWidth=1;
                context.strokeStyle="green";
                context.strokeRect(0,0,50,50);
                context.rect(0,0,50,50);
                context.clip();

                //红色圈
                context.beginPath();
                context.strokeStyle="red";
                context.lineWidth=5;
                context.arc(100,100,100,(Math.PI/180)*0,(Math.PI/180)*360,false);
                context.stroke();
                context.closePath();

                context.restore();

                //再次裁切整个画布
                context.beginPath();
                context.rect(0,0,500,500);
                context.clip();

                //绘制一个蓝色的圈
                context.beginPath();
                context.strokeStyle="blue";
                context.lineWidth=5;
                context.arc(100,100,50,(Math.PI/180)*0,(Math.PI)*360,false);

                context.stroke();
            },
            useGlobalCompositeOperation:function(){
                //background rect
                context.fillStyle="green";//bg1:green
                context.fillRect(10,10,200,800);
                context.fillStyle="black";//bg2:black
                context.fillRect(10,10,200,800);

                context.fillStyle="red";

                //copy
                //context.globalCompositeOperation="copy";
                //context.fillRect(1,1,30,30);

                //destination-atop
                //context.globalCompositeOperation="destination-atop";
                //context.fillRect(1,31,30,30);

                //destination-in
                context.globalCompositeOperation="destination-in";
                context.fillRect(1,61,30,30);

                //destination-out
                //context.globalCompositeOperation="destination-out";
                //context.fillRect(1,91,30,30);

                //destination-over
                //context.globalCompositeOperation="destination-over";
                //context.fillRect(1,121,30,30);

                //lighter
                //context.globalCompositeOperation="lighter";
                //context.fillRect(1,151,30,30);
            },
        }

        drawScreen();
        function drawScreen(){

            //ready.testSaveRestore();
            //ready.useClosePath();
            ready.useLineTo();
            //ready.useArc();
            //ready.useArcTo();
            //ready.useQuadraticCurveTo();
            //ready.useBizierCurveTo();
            //ready.useClip();
            //ready.useGlobalCompositeOperation();
        }
    }
    function initSaveAsImg(){
        $("#save-as-img").click(function(){
            canvas2png(canvas);
        });
    }
</script>

</body>
</html>